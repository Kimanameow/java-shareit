DROP TABLE IF EXISTS users;
DROP TABLE IF EXISTS items;
DROP TABLE IF EXISTS bookings;
DROP TABLE IF EXISTS comments;

CREATE TABLE IF NOT EXISTS users (
id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
name VARCHAR (250) NOT NULL,
email VARCHAR (250) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS items (
id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
name VARCHAR (250) NOT NULL,
description VARCHAR (500) NOT NULL,
available BOOLEAN NOT NULL,
user_id BIGINT NOT NULL,
CONSTRAINT fk_items_users FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS bookings (
id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
start_time TIMESTAMP NOT NULL,
end_time TIMESTAMP NOT NULL,
user_id BIGINT NOT NULL,
item_id BIGINT NOT NULL,
status VARCHAR (40) NOT NULL,
CONSTRAINT fk_bookings_items FOREIGN KEY (item_id) REFERENCES items(id) ON DELETE CASCADE,
CONSTRAINT fk_bookings_users FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS comments (
id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
text VARCHAR (250) NOT NULL,
user_id BIGINT NOT NULL,
item_id BIGINT NOT NULL,
created TIMESTAMP NOT NULL,
CONSTRAINT fk_comment_item FOREIGN KEY (item_id) REFERENCES items(id) ON DELETE CASCADE,
CONSTRAINT fk_user_comm FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
)
